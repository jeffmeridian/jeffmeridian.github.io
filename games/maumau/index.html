<!DOCTYPE html><html lang="de"><head><meta charset="UTF-8"><title>Mau Mau</title><style>body{font-family:sans-serif;background:#28a745;text-align:center;color:#fff;font-size:18px;margin:0;padding:0}h1{font-size:36px}#gameContainer{width:100%;margin:0 auto;transform-origin:top center}#gameArea{border-radius:0;box-shadow:0 0 10px rgba(0,0,0,.2);color:#000;padding:10px}#topCardContainer{display:flex;justify-content:center;margin:2px 0;background-color:#28a745}.card{width:130px;height:230px;margin:1px;border-radius:1px;background-repeat:no-repeat;background-size:contain;background-position:center;cursor:pointer;transition:transform .3s ease}.card:hover{transform:scale(1.1)}.card.disabled-for-7-penalty{opacity:.5;cursor:not-allowed!important}.card.player-card-active{box-shadow:0 0}#topCard{border-radius:1px;background-repeat:no-repeat;background-position:center;box-shadow:0 4px 10px rgba(0,0,0,.2)}#computerHand,#playerHand{font-weight:700;display:flex;justify-content:center;flex-wrap:wrap;color:#fff;font-size:16px;background:#28a745;border-radius:5px;min-height:200px;align-items:flex-start;padding:5px}#computerHand .card{width:130px;height:188.5px;background-size:contain;background-position:center}#drawCardButton{padding:10px 20px;font-size:16px;background:#007bff;color:#fff;border:none;border-radius:5px;margin:10px;cursor:pointer}#drawCardButton:hover{background:#0056b3}#drawCardButton.disabled{background:#6c757d;cursor:not-allowed;opacity:.6}#message{font-size:24px;color:#fff;background:#28a745;padding:5px;border-radius:5px;margin:5px auto;max-width:100%;min-height:30px}#suitSelectionDialog{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;border:2px solid #28a745;border-radius:10px;padding:20px;box-shadow:0 4px 10px rgba(0,0,0,.2);text-align:center;z-index:1000}#suitSelectionDialog img:hover{transform:scale(1.1);transition:transform .2s ease}@media (max-width:768px){#gameContainer{transform:scale(.8)}#topCard,.card{width:150px;height:250px}#message{font-size:18px}}@media (max-width:480px){#gameContainer{transform:scale(.5)}#topCard,.card{width:120px;height:180px}#message{font-size:16px}}</style></head><body><h1>Mau Mau</h1><div id="gameContainer"><div id="gameArea"><div id="computerHand"></div><div id="message"></div><div id="topCardContainer"><div id="topCard" class="card"></div></div><div id="playerHand"></div><button id="drawCardButton">Karte ziehen</button></div></div><button id="restartButton" style="display:none;margin-top:20px;padding:10px 20px;font-size:16px;cursor:pointer">Spiel neu starten</button><div id="suitSelectionDialog" style="display:none"><h3>Wähle eine Farbe:</h3><div style="display:flex;justify-content:center;gap:20px"><img src="images/cards/hearts_ace.svg" alt="Herz" data-suit="hearts" style="width:100px;cursor:pointer"> <img src="images/cards/diamonds_ace.svg" alt="Karo" data-suit="diamonds" style="width:100px;cursor:pointer"> <img src="images/cards/clubs_ace.svg" alt="Kreuz" data-suit="clubs" style="width:100px;cursor:pointer"> <img src="images/cards/spades_ace.svg" alt="Pik" data-suit="spades" style="width:100px;cursor:pointer"></div></div><audio id="victorySound" src="sounds/victory.mp3" preload="auto"></audio><audio id="drawSound" src="sounds/draw.mp3" preload="auto"></audio><audio id="playSound" src="sounds/play.mp3" preload="auto"></audio><audio id="errorSound" src="sounds/error.mp3" preload="auto"></audio><script>const cardFilePath=(e,n)=>`images/cards/${e}_${n}.svg`,suits=["hearts","diamonds","clubs","spades"],ranks=["2","3","4","5","6","7","8","9","10","jack","queen","king","ace"],suitTranslations={hearts:"Herz",diamonds:"Karo",clubs:"Kreuz",spades:"Pik"};let topCard,deck=[],playerHand=[],computerHand=[],currentSuit=null,gameEnded=!1,discardPile=[],currentTurn="player",sevenPenaltyDrawCount=0,soundsEnabled=!0,winnerAnnouncedForEndGame=!1;const playerHandDiv=document.getElementById("playerHand"),computerHandDiv=document.getElementById("computerHand"),topCardDiv=document.getElementById("topCard"),drawCardButton=document.getElementById("drawCardButton"),messageDiv=document.getElementById("message"),suitSelectionDialog=document.getElementById("suitSelectionDialog");function playSoundEffect(e){if(!soundsEnabled)return;const n=document.getElementById(e);n&&"function"==typeof n.play&&(n.currentTime=0,n.play().catch(n=>console.warn(`Sound ${e} play error: ${n.message}`)))}function createDeck(){deck=[];for(let e of suits)for(let n of ranks)deck.push({suit:e,rank:n,id:`${e}_${n}`})}function shuffleDeck(){for(let e=deck.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[deck[e],deck[n]]=[deck[n],deck[e]]}}function dealCard(){if(0===deck.length){if(!(discardPile.length>0))return messageDiv.textContent="Keine Karten mehr verfügbar!",null;if(deck=[...discardPile],discardPile=[],shuffleDeck(),0===deck.length)return messageDiv.textContent="Keine Karten mehr verfügbar! (Reshuffle Problem)",null}if(0===deck.length)return null;const e=deck.pop();return void 0===e?(messageDiv.textContent="Keine Karten mehr verfügbar! (Pop undefined)",null):(playSoundEffect("drawSound"),e)}function isValidMove(e){return!topCard||(sevenPenaltyDrawCount>0&&"player"===currentTurn?"7"===e.rank:"jack"===topCard.rank&&currentSuit?e.suit===currentSuit||"jack"===e.rank:("8"!==topCard.rank||"8"!==e.rank)&&("jack"===e.rank||e.suit===topCard.suit||e.rank===topCard.rank))}function displayHands(){playerHandDiv.innerHTML="<div>Deine Karten:</div>",playerHand.forEach(e=>{const n=document.createElement("div");n.classList.add("card");let t="player"===currentTurn&&!gameEnded;t&&n.classList.add("player-card-active"),n.style.backgroundImage=`url('${cardFilePath(e.suit,e.rank)}')`;let a=!0;"player"===currentTurn&&sevenPenaltyDrawCount>0&&"7"!==e.rank&&(n.classList.add("disabled-for-7-penalty"),a=!1),t&&a?n.onclick=()=>{"player"!==currentTurn||gameEnded||playCard(playerHand.findIndex(n=>n.id===e.id))}:t&&!a&&(n.onclick=()=>{"player"===currentTurn&&!gameEnded&&sevenPenaltyDrawCount>0&&"7"!==e.rank&&(playSoundEffect("errorSound"),messageDiv.textContent=`Ungültig! Du musst ${sevenPenaltyDrawCount} Karten ziehen oder eine 7 spielen.`)}),playerHandDiv.appendChild(n)}),computerHandDiv.innerHTML="<div>Computer Karten:</div>",computerHand.forEach(()=>{const e=document.createElement("div");e.classList.add("card"),e.style.backgroundImage="url('images/cards/backside.svg')",computerHandDiv.appendChild(e)}),topCard&&(topCardDiv.style.backgroundImage=`url('${cardFilePath(topCard.suit,topCard.rank)}')`),checkPlayerSevenPenalty(),"player"!==currentTurn||gameEnded?(drawCardButton.classList.add("disabled"),drawCardButton.disabled=!0):(drawCardButton.classList.remove("disabled"),drawCardButton.disabled=!1)}function checkPlayerSevenPenalty(){"player"!==currentTurn||gameEnded||(sevenPenaltyDrawCount>0?(drawCardButton.textContent=`${sevenPenaltyDrawCount} Karten ziehen`,drawCardButton.onclick=handlePlayerSevenDrawObligation):(drawCardButton.textContent="Karte ziehen",drawCardButton.onclick=drawCard))}function handlePlayerSevenDrawObligation(){gameEnded||"player"!==currentTurn||sevenPenaltyDrawCount<=0||(messageDiv.textContent=`Du ziehst ${sevenPenaltyDrawCount} Karten.`,drawCards(playerHand,sevenPenaltyDrawCount),sevenPenaltyDrawCount=0,endTurn("computer"))}function playCard(e){if(gameEnded||"player"!==currentTurn)return;if(-1===e||e>=playerHand.length)return console.error("playCard: Invalid index",e),void displayHands();const n=playerHand[e];let t="";if(console.log("Player's remaining cards:",playerHand.map(e=>`${e.rank} of ${e.suit}`)),console.log(`Player plays: ${n.rank} of ${n.suit}`),1===playerHand.length&&"jack"===n.rank&&isValidMove(n)){playSoundEffect("errorSound"),messageDiv.textContent="Du darfst das Spiel nicht mit einem Buben beenden! Ziehe eine Karte.";const e=dealCard();return e?(playerHand.push(e),messageDiv.textContent+=" Du hast eine Karte gezogen."):messageDiv.textContent+=" Stapel leer, du kannst nicht ziehen.",void endTurn("computer")}if(sevenPenaltyDrawCount>0){if("7"!==n.rank)return playSoundEffect("errorSound"),void(messageDiv.textContent=`Ungültig! Du musst ${sevenPenaltyDrawCount} Karten ziehen oder eine 7 spielen.`);topCard&&discardPile.push(topCard),topCard=n,playerHand.splice(e,1),playSoundEffect("playSound"),sevenPenaltyDrawCount+=2,t=`Du konterst mit 7! Computer muss ${sevenPenaltyDrawCount} Karten ziehen oder 7 legen.`,messageDiv.textContent=t}else{if(!isValidMove(n))return playSoundEffect("errorSound"),void(messageDiv.textContent="Ungültiger Zug!");if(topCard&&discardPile.push(topCard),topCard=n,playerHand.splice(e,1),playSoundEffect("playSound"),"7"===n.rank)sevenPenaltyDrawCount+=2,t=`Du spielst 7! Computer muss ${sevenPenaltyDrawCount} Karten ziehen oder 7 legen.`;else{if("8"===n.rank){sevenPenaltyDrawCount=0;const e=n.suit;return t=`Du spielst eine 8 (${suitTranslations[e]}).`,messageDiv.textContent=t,void setTimeout(()=>{if(gameEnded)return;if(playerHand.some(n=>n.suit===e))messageDiv.textContent=t+` Du hast noch ${suitTranslations[e]}, spiele nochmal!`,currentTurn="player",displayHands();else{messageDiv.textContent=t+` Keine passende Karte (${suitTranslations[e]}). Du ziehst eine.`;const n=dealCard();n&&playerHand.push(n),endTurn("computer")}},150)}if("jack"===n.rank)return sevenPenaltyDrawCount=0,t="Du spielst einen Buben.",messageDiv.textContent=t,void chooseSuit();currentSuit=null,t=`Du spielst ${suitTranslations[n.suit]} ${n.rank}.`}messageDiv.textContent=t}0!==playerHand.length||gameEnded?gameEnded?displayHands():endTurn("computer"):endGame("Spieler")}function chooseSuit(){suitSelectionDialog.style.display="block",suitSelectionDialog.querySelectorAll("img").forEach(e=>{const n=e.cloneNode(!0);e.parentNode.replaceChild(n,e),n.addEventListener("click",function(){gameEnded||"player"!==currentTurn||(currentSuit=this.getAttribute("data-suit"),messageDiv.textContent=`Du wählst ${suitTranslations[currentSuit]}.`,suitSelectionDialog.style.display="none",endTurn("computer"))})})}function computerTurn(){gameEnded||"computer"!==currentTurn||setTimeout(()=>{if(gameEnded)return;let e="";if(sevenPenaltyDrawCount>0){const n=computerHand.findIndex(e=>"7"===e.rank);if(-1!==n){const t=computerHand[n];topCard&&discardPile.push(topCard),topCard=t,computerHand.splice(n,1),playSoundEffect("playSound"),sevenPenaltyDrawCount+=2,e=`Computer kontert mit 7! Du musst ${sevenPenaltyDrawCount} Karten ziehen oder 7 legen.`,console.log(`Computer plays: ${t.rank} of ${t.suit}`),console.log("Computer's remaining cards:",computerHand.map(e=>`${e.rank} of ${e.suit}`))}else e=`Computer zieht ${sevenPenaltyDrawCount} Strafkarten.`,drawCards(computerHand,sevenPenaltyDrawCount),sevenPenaltyDrawCount=0}else{if("8"===topCard.rank)return e="Computer kann nicht auf eine 8 spielen. Spieler ist dran.",messageDiv.textContent=e,void endTurn("player");{let n=[];for(let e=0;e<computerHand.length;e++)isValidMove(computerHand[e])&&n.push(computerHand[e]);let t=null;if(n.length>0){let a=n.filter(e=>!(1===computerHand.length&&"jack"===e.rank));if(a.length>0)t=a.find(e=>"jack"!==e.rank)||a[0];else{t=null,e="Computer hat nur Bube(n), darf nicht gewinnen & zieht.";const n=dealCard();n?(computerHand.push(n),e+=" Computer hat eine Karte gezogen."):e+=" Stapel leer.",messageDiv.textContent=e,endTurn("player")}}if(t){const n=computerHand.findIndex(e=>e.id===t.id);if(-1===n)console.error("Computer card to play not found by ID:",t.id),t=null,e="Computer Kartenfehler.";else if(topCard&&discardPile.push(topCard),topCard=t,computerHand.splice(n,1),playSoundEffect("playSound"),console.log(`Computer plays: ${t.rank} of ${t.suit}`),console.log("Computer's remaining cards:",computerHand.map(e=>`${e.rank} of ${e.suit}`)),"7"===t.rank)sevenPenaltyDrawCount+=2,e=`Computer spielt 7! Du musst ${sevenPenaltyDrawCount} Karten ziehen oder 7 legen.`;else{if("8"===t.rank)return sevenPenaltyDrawCount=0,e="Computer spielt 8. Computer ist nochmal dran.",messageDiv.textContent=e,void(0!==computerHand.length||gameEnded?gameEnded||computerTurn():endGame("Computer"));if("jack"===t.rank){sevenPenaltyDrawCount=0;let n={};computerHand.filter(e=>"jack"!==e.rank).forEach(e=>{n[e.suit]=(n[e.suit]||0)+1});let t=null,a=0;for(const e of suits)(n[e]||0)>a&&(a=n[e],t=e);currentSuit=t||suits[Math.floor(Math.random()*suits.length)],e=`Computer spielt Bube und wählt ${suitTranslations[currentSuit]}.`}else currentSuit=null,e=`Computer spielt ${suitTranslations[t.suit]} ${t.rank}.`}}if(!t){e="Computer zieht eine Karte.";const n=dealCard();n?computerHand.push(n):e+=" Stapel leer."}}}messageDiv.textContent=e,0!==computerHand.length||gameEnded?gameEnded||endTurn("player"):endGame("Computer")},1500)}function drawCard(){if(gameEnded||"player"!==currentTurn)return;if(sevenPenaltyDrawCount>0)return void handlePlayerSevenDrawObligation();const e=dealCard();e?(playerHand.push(e),messageDiv.textContent="Du hast eine Karte gezogen."):messageDiv.textContent="Stapel leer! Du kannst nicht ziehen.",endTurn("computer")}function drawCards(e,n){let t=0;for(let a=0;a<n;a++){const n=dealCard();if(!n){console.warn("Stapel beim Ziehen leer geworden!");break}e.push(n),console.log(`${"player"===currentTurn?"Player":"Computer"} draws: ${n.rank} of ${n.suit}`),console.log("Computer's remaining cards:",computerHand.map(e=>`${e.rank} of ${e.suit}`)),t++}return t}function endTurn(e){gameEnded&&winnerAnnouncedForEndGame&&"none"!==e?displayHands():(currentTurn=e,"player"===e?sevenPenaltyDrawCount>0?messageDiv.textContent=`Du musst ${sevenPenaltyDrawCount} Karten ziehen oder 7 legen!`:(messageDiv.textContent.includes("denkt nach...")||""===messageDiv.textContent)&&(messageDiv.textContent="Du bist am Zug."):"computer"===e&&(messageDiv.textContent=sevenPenaltyDrawCount>0?`Computer muss ${sevenPenaltyDrawCount} Karten ziehen oder 7 legen.`:"Computer denkt nach..."),displayHands(),"computer"!==e||gameEnded||computerTurn())}function endGame(e){gameEnded&&winnerAnnouncedForEndGame||(gameEnded=!0,winnerAnnouncedForEndGame=!0,currentTurn="none",messageDiv.textContent=`${e} hat gewonnen!`,"Spieler"===e&&playSoundEffect("victorySound"),document.getElementById("restartButton").style.display="block",document.getElementById("restartButton").onclick=startGame,displayHands())}async function startGame(){createDeck(),shuffleDeck(),playerHand=[],computerHand=[],discardPile=[],sevenPenaltyDrawCount=0,winnerAnnouncedForEndGame=!1,gameEnded=!1;for(let e=0;e<5;e++){const e=dealCard();e?playerHand.push(e):console.error(" startGame: Failed to deal player card");const n=dealCard();n?computerHand.push(n):console.error(" startGame: Failed to deal computer card")}for(topCard=dealCard();topCard&&("7"===topCard.rank||"8"===topCard.rank||"jack"===topCard.rank);)discardPile.push(topCard),topCard=dealCard();if(!topCard)return alert("Konnte kein gültiges Startblatt finden! Deck möglicherweise leer."),messageDiv.textContent="Fehler beim Spielaufbau: Keine gültige Startkarte.",void(gameEnded=!0);currentSuit=null,currentTurn="player",drawCardButton.disabled=!1,messageDiv.textContent="Du bist am Zug.",document.getElementById("restartButton").style.display="none",displayHands()}const delay=e=>new Promise(n=>setTimeout(n,e));async function testEightRules(){if(soundsEnabled=!1,console.log("--- testEightRules ---"),console.log("\nS1 (8-rule): P plays H8 (no other H), draws 1. C cant play on H8, draws 1. P's turn."),await startGame(),gameEnded)return void console.error("S1 8-rule: startGame failed.");playerHand=[{suit:"hearts",rank:"8",id:"h8"},{suit:"diamonds",rank:"9",id:"d9"}],computerHand=[{suit:"spades",rank:"6",id:"s6"},{suit:"clubs",rank:"10",id:"c10"}];const e=computerHand.length;topCard={suit:"hearts",rank:"6",id:"h6"},currentTurn="player",sevenPenaltyDrawCount=0,gameEnded=!1,winnerAnnouncedForEndGame=!1,messageDiv.textContent="Test S1 (8-rule): Player to play H8",displayHands();let n=playerHand.length;playCard(playerHand.findIndex(e=>"h8"===e.id)),await delay(1850);const t=n,a=e+1;if(playerHand.length===t&&computerHand.length===a&&"player"===currentTurn?console.log("Test S1 (8-rule) PASSED."):console.error(`Test S1 (8-rule) FAILED: P Hand Actual:${playerHand.length}(Exp:${t}), C Hand Actual:${computerHand.length}(Exp:${a}), Turn Actual:${currentTurn}(Exp:player)`),console.log("\nS2 (8-rule): P plays C8 (has other C). P's turn to play C again."),await startGame(),gameEnded)return void console.error("S2 8-rule: startGame failed.");const r="clubs";playerHand=[{suit:r,rank:"8",id:"c8_s2"},{suit:r,rank:"ace",id:"ca_s2"},{suit:"diamonds",rank:"9",id:"d9_s2"}],computerHand=[{suit:"spades",rank:"7",id:"s7_s2"},{suit:"hearts",rank:"9",id:"h9_s2"}],topCard={suit:r,rank:"6",id:"c6_s2"},currentTurn="player",sevenPenaltyDrawCount=0,gameEnded=!1,winnerAnnouncedForEndGame=!1,messageDiv.textContent="Test S2 (8-rule): Player to play C8 (has same suit)",displayHands();let d=playerHand.length;playCard(playerHand.findIndex(e=>"c8_s2"===e.id)),await delay(250),playerHand.length===d-1&&"player"===currentTurn?console.log("Test S2 (8-rule) PASSED."):console.error(`Test S2 (8-rule) FAILED: P Hand Actual:${playerHand.length}(Exp:${d-1}), Turn Actual:${currentTurn}(Exp:player)`),console.log("--- testEightRules completed ---")}async function testSevenRules_NewLogic(){if(soundsEnabled=!1,console.log("--- testSevenRules_NewLogic ---"),console.log("\nS1 (7-rule): P plays H7 (pen=2). C no 7, draws 2. P's turn."),await startGame(),gameEnded)return void console.error("S1 7-rule: startGame failed.");playerHand=[{suit:"hearts",rank:"7",id:"h7_s1_7"},{suit:"diamonds",rank:"king",id:"dk_s1_7"}],computerHand=[{suit:"spades",rank:"king",id:"sk_s1_7"},{suit:"clubs",rank:"9",id:"c9_s1_7"}];const e=computerHand.length;topCard={suit:"hearts",rank:"6",id:"h6_s1_7"},currentTurn="player",sevenPenaltyDrawCount=0,gameEnded=!1,winnerAnnouncedForEndGame=!1,messageDiv.textContent="Test S1 (7-rule): P to play H7",displayHands();let n=playerHand.length;playCard(playerHand.findIndex(e=>"h7_s1_7"===e.id)),await delay(1700);const t=n-1,a=e+2;if(playerHand.length===t&&computerHand.length===a&&0===sevenPenaltyDrawCount&&"player"===currentTurn?console.log("Test S1 (7-rule) PASSED."):console.error(`Test S1 (7-rule) FAILED. P Hand Actual:${playerHand.length}(Exp:${t}), C Hand Actual:${computerHand.length}(Exp:${a}), Penalty Actual:${sevenPenaltyDrawCount}(Exp:0), Turn Actual:${currentTurn}(Exp:player)`),console.log("\nS2 (7-rule): P plays H7 (pen=2). C plays S7 (pen=4). P no 7, draws 4. C's turn. C no play on S7, draws 1. P's turn."),await startGame(),gameEnded)return void console.error("S2 7-rule: startGame failed.");playerHand=[{suit:"hearts",rank:"7",id:"h7_s2_7"},{suit:"diamonds",rank:"king",id:"dk_s2_7"}],computerHand=[{suit:"spades",rank:"7",id:"s7_s2_7"},{suit:"clubs",rank:"9",id:"c9_s2_7"}];const r=computerHand.length;topCard={suit:"hearts",rank:"6",id:"h6_s2_7"},currentTurn="player",sevenPenaltyDrawCount=0,gameEnded=!1,winnerAnnouncedForEndGame=!1,messageDiv.textContent="Test S2 (7-rule): P to play H7, C to counter",displayHands();let d=playerHand.length;playCard(playerHand.findIndex(e=>"h7_s2_7"===e.id)),await delay(1700),"player"===currentTurn&&4===sevenPenaltyDrawCount?handlePlayerSevenDrawObligation():console.error(`Test S2 (7-rule) FAILED (pre-P-draw). Penalty Actual:${sevenPenaltyDrawCount}(Exp:4), Turn Actual:${currentTurn}(Exp:player)`),await delay(1700);const s=d-1+4,o=r-1+1;playerHand.length===s&&computerHand.length===o&&0===sevenPenaltyDrawCount&&"player"===currentTurn?console.log("Test S2 (7-rule) PASSED."):console.error(`Test S2 (7-rule) FAILED (post-P-draw & C-turn). P Hand Actual:${playerHand.length}(Exp:${s}), C Hand Actual:${computerHand.length}(Exp:${o}), Penalty Actual:${sevenPenaltyDrawCount}(Exp:0), Turn Actual:${currentTurn}(Exp:player)`),console.log("--- testSevenRules_NewLogic completed ---")}async function testJackCannotEndGame(){if(soundsEnabled=!1,console.log("--- testJackCannotEndGame ---"),console.log("\nS1 (JackEnd): Player last card is Jack. Should draw, turn passes."),await startGame(),gameEnded&&!playerHand.length)return void console.error("S1 JackEnd: startGame failed critically.");playerHand=[{suit:"hearts",rank:"jack",id:"hj1_je"}],computerHand=[{suit:"spades",rank:"9",id:"s9_je1"},{suit:"clubs",rank:"king",id:"ck_je1"}],deck=[{suit:"clubs",rank:"2",id:"c2_deck_sJ1"},{suit:"clubs",rank:"3",id:"c3_deck_sJ1"}],discardPile=[],topCard={suit:"hearts",rank:"ace",id:"ha_je1"},currentTurn="player",gameEnded=!1,winnerAnnouncedForEndGame=!1,sevenPenaltyDrawCount=0,currentSuit=null,messageDiv.textContent="Test S1 (JackEnd): Player to play last Jack",displayHands();const e=playerHand.length;if(playCard(0),await delay(300),playerHand.length!==e+1||gameEnded||"computer"!==currentTurn?console.error(`Test S1 (JackEnd) FAILED: P Hand:${playerHand.length}(Exp:${e+1}), GameEnd:${gameEnded}(Exp:F), Turn:${currentTurn}(Exp:computer)`):console.log("Test S1 (JackEnd) PASSED."),console.log("\nS2 (JackEnd): Computer last card is Jack. Should draw, turn passes."),await startGame(),gameEnded&&!playerHand.length)return void console.error("S2 JackEnd: startGame failed critically.");playerHand=[{suit:"hearts",rank:"9",id:"h9_je2"},{suit:"clubs",rank:"king",id:"ck_je2"}],computerHand=[{suit:"spades",rank:"jack",id:"sj1_je"}],deck=[{suit:"clubs",rank:"2",id:"c2_deck_sJ2"},{suit:"clubs",rank:"3",id:"c3_deck_sJ2"}],discardPile=[];const n=computerHand.length;topCard={suit:"spades",rank:"ace",id:"sa_je2"},currentTurn="computer",gameEnded=!1,winnerAnnouncedForEndGame=!1,sevenPenaltyDrawCount=0,currentSuit=null,messageDiv.textContent="Test S2 (JackEnd): Computer's turn, last Jack",displayHands(),computerTurn(),await delay(1800),computerHand.length!==n+1||gameEnded||"player"!==currentTurn?console.error(`Test S2 (JackEnd) FAILED: C Hand:${computerHand.length}(Exp:${n+1}), GameEnd:${gameEnded}(Exp:F), Turn:${currentTurn}(Exp:player)`):console.log("Test S2 (JackEnd) PASSED."),console.log("--- testJackCannotEndGame completed ---")}async function testEightCounterRule(){console.log("--- testEightCounterRule ---"),console.log("\nS1: Player plays an 8. Computer should not counter with another 8 or a jack."),await startGame(),playerHand=[{suit:"hearts",rank:"8",id:"h8_test"},{suit:"diamonds",rank:"9",id:"d9_test"}],computerHand=[{suit:"hearts",rank:"8",id:"h8_computer"},{suit:"spades",rank:"jack",id:"sj_computer"},{suit:"clubs",rank:"9",id:"c9_computer"}],topCard={suit:"hearts",rank:"6",id:"h6_test"},currentTurn="player",gameEnded=!1,winnerAnnouncedForEndGame=!1,sevenPenaltyDrawCount=0,currentSuit=null,messageDiv.textContent="Test S1 (8-counter): Player plays an 8.",displayHands(),playCard(playerHand.findIndex(e=>"h8_test"===e.id)),await delay(1500),console.log("Computer's remaining cards:",computerHand.map(e=>`${e.rank} of ${e.suit}`)),"player"===currentTurn?console.log("Test S1 (8-counter) PASSED: Computer did not counter with an 8 or a jack and passed the turn."):console.error(`Test S1 (8-counter) FAILED: Turn did not pass back to the player. Current turn: ${currentTurn}.`),console.log("--- testEightCounterRule completed ---")}async function runTestsAndStartGame(){console.log("--- Running Automated Tests ---"),soundsEnabled=!1,await testEightCounterRule(),console.log("--- Automated Tests Completed ---"),console.log("--- Starting Game ---"),gameEnded||(soundsEnabled=!0)}runTestsAndStartGame()</script></body></html>```